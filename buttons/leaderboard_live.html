<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Live Leaderboard</title>
  <style>
    body {
      background: black;
      color: #0ff;
      font-family: 'Segoe UI', sans-serif;
      text-align: center;
      margin: 0;
      height: 100vh;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      overflow: hidden;
    }

    iframe {
      width: 100%;
      height: 100%;
      border: none;
      transition: opacity 0.8s ease;
    }

    #timestamp {
      position: fixed;
      bottom: 10px;
      right: 10px;
      color: #0ff;
      font-size: 14px;
      font-family: monospace;
      opacity: 0.7;
      background: rgba(0,0,0,0.3);
      padding: 4px 8px;
      border-radius: 6px;
    }

    #refreshBtn {
      position: fixed;
      bottom: 10px;
      left: 10px;
      background: linear-gradient(135deg, #0077ff, #00ffff);
      border: none;
      color: #000;
      font-weight: bold;
      font-size: 14px;
      padding: 6px 14px;
      border-radius: 6px;
      cursor: pointer;
      transition: transform 0.2s ease, box-shadow 0.3s ease;
    }

    #refreshBtn:hover {
      transform: scale(1.05);
      box-shadow: 0 0 10px #00ffff;
    }
  </style>
</head>
<body>

  <!-- Fast auto-refreshing wrapper -->
  <iframe
    id="leaderboardFrame"
    src="https://andrewveda.github.io/SRM-VEC-English-PWA/buttons/leaderboard?t=0"
    loading="lazy"
  ></iframe>

  <div id="timestamp"></div>
  <button id="refreshBtn">ðŸ”„ Refresh Now</button>

  <script>
    const iframe = document.getElementById('leaderboardFrame');
    const timestamp = document.getElementById('timestamp');
    const refreshBtn = document.getElementById('refreshBtn');

    function updateTimestamp() {
      const now = new Date();
      timestamp.textContent = "Last refreshed: " + now.toLocaleTimeString();
    }

    // ðŸ”„ Soft refresh â€” loads a new iframe in background, swaps it in silently
    function refreshLeaderboard() {
      const newIframe = document.createElement('iframe');
      newIframe.src = "https://andrewveda.github.io/SRM-VEC-English-PWA/buttons/leaderboard?t=" + Date.now();
      newIframe.loading = "lazy";
      newIframe.style.position = "absolute";
      newIframe.style.top = "0";
      newIframe.style.left = "0";
      newIframe.style.width = "100%";
      newIframe.style.height = "100%";
      newIframe.style.border = "none";
      newIframe.style.opacity = "0";

      document.body.appendChild(newIframe);

      // When new iframe finishes loading, swap it in
      newIframe.onload = () => {
        iframe.remove();
        newIframe.style.position = "relative";
        newIframe.style.opacity = "1";
        newIframe.id = "leaderboardFrame";
        updateTimestamp();
      };
    }

    refreshBtn.addEventListener('click', refreshLeaderboard);

    // Optional: auto-refresh every 60 seconds (non-blocking)
    setInterval(refreshLeaderboard, 60000);

    updateTimestamp();
  </script>
</body>
</html>
